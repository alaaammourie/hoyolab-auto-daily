name: Verify Secrets

on:
  workflow_dispatch:  # Allows manual trigger
  push:
    branches: [ main, develop ]

jobs:
  verify-secrets:
    runs-on: ubuntu-latest
    name: Check Required Secrets
    
    steps:
    - name: Verify all required secrets
      run: |
        echo "🔍 Checking required secrets..."
        echo "=================================="
        
        # List your required secrets here
        declare -A secrets=(
          ["COOKIE"]="$COOKIE"
        )
        
        missing_secrets=()
        
        for secret_name in "${!secrets[@]}"; do
          secret_value="${secrets[$secret_name]}"
          
          if [[ -z "$secret_value" ]]; then
            echo "❌ $secret_name: NOT SET"
            missing_secrets+=("$secret_name")
          else
            echo "✅ $secret_name: CONFIGURED (${#secret_value} chars)"
          fi
        done
        
        echo "=================================="
        
        if [[ ${#missing_secrets[@]} -gt 0 ]]; then
          echo "🚨 Missing secrets detected!"
          echo "Please add these secrets in Settings > Secrets and variables > Actions:"
          for secret in "${missing_secrets[@]}"; do
            echo "  • $secret"
          done
          exit 1
        else
          echo "🎉 All secrets are properly configured!"
        fi
      env:
        COOKIE: ${{ secrets.COOKIE }}